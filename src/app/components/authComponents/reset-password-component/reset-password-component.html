<section class="py-28 bg-white dark:bg-slate-950 transition-colors duration-500">
    <div class="max-w-6xl mx-auto px-6">
        <div class="container mx-auto">
            <div class="flex items-center justify-center min-h-screen p-4 relative">
                
                <div class="bg-linear-to-b md:bg-linear-to-r from-white to-cyan-200 
                            dark:from-slate-900 dark:to-cyan-950 shadow-2xl rounded-4xl p-6 sm:p-10 w-full max-w-lg border dark:border-slate-800 transition-all">
                    
                    <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">Reset Password</h1>

                    @if (errorText) {
                        <div class="my-4 p-3 rounded-2xl text-center font-semibold bg-cyan-300 dark:bg-cyan-900/50 dark:text-cyan-200 shadow-xl border dark:border-cyan-800 transition-all">
                            {{ errorText }}
                        </div>
                    }

                    <form [formGroup]="resetForm" (ngSubmit)="resetPassword()">
                        <p class="mb-4 text-sm text-gray-600 dark:text-slate-400">Resetting password for: <b class="text-cyan-700 dark:text-cyan-400">{{ userEmail }}</b></p>

                        <div class="my-5">
                            <label for="newPassword" class="mb-2 block capitalize font-bold dark:text-slate-200">New Password:</label>
                            <input type="password" id="newPassword" class="form-control dark:bg-slate-900 dark:text-white dark:border-slate-700 focus:ring-2 focus:ring-cyan-500 outline-none transition-all" 
                                formControlName="newPassword"
                                [ngClass]="{
                                    'valid': !resetForm.get('newPassword')?.errors && (resetForm.get('newPassword')?.touched || resetForm.get('newPassword')?.dirty),
                                    'invalid': resetForm.get('newPassword')?.errors && (resetForm.get('newPassword')?.touched || resetForm.get('newPassword')?.dirty)
                                }">

                            @if(resetForm.get('newPassword')?.errors && resetForm.get('newPassword')?.touched){
                                <div class="bg-cyan-300 dark:bg-cyan-900/40 dark:text-cyan-200 text-lg p-3 rounded-2xl my-3 font-semibold shadow-2xl">
                                    @if(resetForm.get('newPassword')?.getError('required')){<p>Password is required</p>}
                                    @else if(resetForm.get('newPassword')?.getError('pattern')){<p>Password format is not correct (min 6 characters)</p>}
                                </div>
                            }
                        </div>

                        <div class="my-5">
                            <label for="confirmPassword" class="mb-2 block capitalize font-bold dark:text-slate-200">Confirm New Password:</label>
                            <input type="password" id="confirmPassword" class="form-control dark:bg-slate-900 dark:text-white dark:border-slate-700 focus:ring-2 focus:ring-cyan-500 outline-none transition-all" 
                                formControlName="confirmPassword"
                                [ngClass]="{
                                    'valid': !resetForm.getError('missMatch') && (resetForm.get('confirmPassword')?.touched || resetForm.get('confirmPassword')?.dirty),
                                    'invalid': resetForm.getError('missMatch') && (resetForm.get('confirmPassword')?.touched || resetForm.get('confirmPassword')?.dirty)
                                }">

                            @if(resetForm.getError('missMatch') && resetForm.get('confirmPassword')?.touched){
                                <div class="bg-cyan-300 dark:bg-cyan-900/40 dark:text-cyan-200 text-lg p-3 rounded-2xl my-3 font-semibold shadow-2xl">
                                    <p>Confirm password is not correct</p>
                                </div>
                            }
                        </div>
                        
                        <button type="submit" [disabled]="resetForm.invalid || loading" 
                            class="w-full cursor-pointer p-3 rounded-2xl text-white font-bold transition-all shadow-2xl border-2 border-cyan-300 dark:border-cyan-800"
                            [ngClass]="{
                                'bg-cyan-500 hover:bg-cyan-600': !resetForm.invalid && !loading,
                                'bg-cyan-300 dark:bg-slate-800 dark:text-slate-500': resetForm.invalid || loading
                            }">
                            Set New Password
                            @if (loading) { <span class="ml-2"><i class="fa-solid fa-circle-notch fa-spin"></i></span> }
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>